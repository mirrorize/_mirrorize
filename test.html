<html>

<head>
<script>

class AT extends HTMLElement {
  constructor () {
    super()
    var shadow = this.attachShadow({ mode: 'open' })
    shadow.innerHTML = `
    <style>
    :host {
      display: block;
    }
    :host([hidden]) {
      display:none;
    }
    </style>
    <div>
    <p>The Time - Black Eyed Peas </p>
    <p>The Time - Black Eyed Peas </p>
    <p>The Time - Black Eyed Peas </p>
    <p>The Time - Black Eyed Peas </p>
    <p>The Time - Black Eyed Peas </p>
    <p>The Time - Black Eyed Peas </p>
    </div>
    `
  }
}

window.customElements.define('a-t', AT)

setTimeout(() => {
  var x = document.querySelector('#why')
  x.style.opacity = 0.5
  console.log('animate')
  var tests = document.querySelectorAll('.test')
  for (var t of [...tests]) {
    console.log(t)
    var animation = [
      { transform: 'translateY(0px)' },
      {
        transform: 'translateY(300px)',
        opacity: 0.3
      }
    ]
    var ani = t.animate(animation, {
      // timing options
      duration: 1000,
      fill: 'forwards',
    })
    ani.onfinish = () => {
      var last = animation[animation.length - 1]
      var keys = Object.keys(last)
      for (var name of keys) {
        t.style[name] = last[name]
      }
      console.log('end', t)
    }
  }
}, 1000)

</script>
</head>

<body>
  <a-t class="test" id="why"></a-t>
  <div class="test">
    <p>Electric Boogie - XXX </p>
    <p>Electric Boogie - XXX </p>
    <p>Electric Boogie - XXX </p>
    <p>Electric Boogie - XXX </p>
    <p>Electric Boogie - XXX </p>
    <p>Electric Boogie - XXX </p>
  </div>
</body>

</html>
